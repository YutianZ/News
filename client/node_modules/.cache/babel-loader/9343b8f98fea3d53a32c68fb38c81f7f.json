{"ast":null,"code":"import _classCallCheck from \"/Users/yz/Documents/Projects/news/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/yz/Documents/Projects/news/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/yz/Documents/Projects/news/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/yz/Documents/Projects/news/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/yz/Documents/Projects/news/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/yz/Documents/Projects/news/client/src/NewsPanel/NewsPanel.js\";\nimport React from 'react'; //import './NewsPanel.css';\n\nimport _ from 'lodash';\nimport NewsCard from '../NewsCard/NewsCard';\n\nvar NewsPanel =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(NewsPanel, _React$Component);\n\n  function NewsPanel() {\n    var _this;\n\n    _classCallCheck(this, NewsPanel);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NewsPanel).call(this));\n    _this.state = {\n      news: null\n    };\n    return _this;\n  }\n\n  _createClass(NewsPanel, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.loadMoreNews();\n      this.loadMoreNews = _.debounce(this.loadMoreNews, 1000);\n      window.addEventListener('scroll', function () {\n        return _this2.handleScroll();\n      });\n    }\n  }, {\n    key: \"loadMoreNews\",\n    value: function loadMoreNews() {\n      var _this3 = this;\n\n      //TODO: send real http request;\n      var news_url = 'http://' + window.location.hostname + ':3000/news';\n      var request = new Request(news_url, {\n        method: 'GET'\n      });\n      fetch(request).then(function (res) {\n        return res.json();\n      }).then(function (news) {\n        _this3.setState({\n          news: _this3.state.news ? _this3.state.news.concat(news) : news\n        });\n      });\n    }\n  }, {\n    key: \"handleScroll\",\n    value: function handleScroll() {\n      //document.body.offsetHeight\n      //scrollY\n      //window.innerHeight\n      var scrollY = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;\n\n      if (window.innerHeight + scrollY >= document.body.offsetHeight - 50) {\n        this.loadMoreNews();\n      }\n    }\n  }, {\n    key: \"renderNews\",\n    value: function renderNews() {\n      var news_list = this.state.news.map(function (news) {\n        return (//every news has a special digest, use it as key\n          React.createElement(\"a\", {\n            className: \"list-group-item\",\n            key: news.digest,\n            href: \"#\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 44\n            },\n            __self: this\n          }, React.createElement(NewsCard, {\n            news: news,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 45\n            },\n            __self: this\n          }))\n        );\n      });\n      return React.createElement(\"div\", {\n        className: \"container-fluid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"list-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }, news_list));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (!this.state.news) {\n        return React.createElement(\"div\", {\n          id: \"msg-app-loading\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 61\n          },\n          __self: this\n        }, \"loading...\");\n      } else {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 67\n          },\n          __self: this\n        }, this.renderNews());\n      }\n    }\n  }]);\n\n  return NewsPanel;\n}(React.Component);\n\nexport default NewsPanel;","map":{"version":3,"sources":["/Users/yz/Documents/Projects/news/client/src/NewsPanel/NewsPanel.js"],"names":["React","_","NewsCard","NewsPanel","state","news","loadMoreNews","debounce","window","addEventListener","handleScroll","news_url","location","hostname","request","Request","method","fetch","then","res","json","setState","concat","scrollY","pageYOffset","document","documentElement","scrollTop","innerHeight","body","offsetHeight","news_list","map","digest","renderNews","Component"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB,C,CACA;;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,QAAP,MAAqB,sBAArB;;IACMC,S;;;;;AACF,uBAAc;AAAA;;AAAA;;AACV;AACA,UAAKC,KAAL,GAAa;AAACC,MAAAA,IAAI,EAAE;AAAP,KAAb;AAFU;AAGb;;;;wCAEmB;AAAA;;AAChB,WAAKC,YAAL;AACA,WAAKA,YAAL,GAAoBL,CAAC,CAACM,QAAF,CAAW,KAAKD,YAAhB,EAA8B,IAA9B,CAApB;AACAE,MAAAA,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC;AAAA,eAAM,MAAI,CAACC,YAAL,EAAN;AAAA,OAAlC;AACH;;;mCAEc;AAAA;;AACX;AACA,UAAMC,QAAQ,GAAG,YAAYH,MAAM,CAACI,QAAP,CAAgBC,QAA5B,GAAuC,YAAxD;AACA,UAAMC,OAAO,GAAE,IAAIC,OAAJ,CAAYJ,QAAZ,EAAsB;AAACK,QAAAA,MAAM,EAAC;AAAR,OAAtB,CAAf;AAEAC,MAAAA,KAAK,CAACH,OAAD,CAAL,CACKI,IADL,CACU,UAAAC,GAAG;AAAA,eAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,OADb,EAEKF,IAFL,CAEU,UAAAb,IAAI,EAAI;AACV,QAAA,MAAI,CAACgB,QAAL,CAAc;AAAChB,UAAAA,IAAI,EAAE,MAAI,CAACD,KAAL,CAAWC,IAAX,GAAkB,MAAI,CAACD,KAAL,CAAWC,IAAX,CAAgBiB,MAAhB,CAAuBjB,IAAvB,CAAlB,GAAiDA;AAAxD,SAAd;AAEH,OALL;AAMH;;;mCAEc;AACX;AACA;AACA;AACA,UAAIkB,OAAO,GAAGf,MAAM,CAACe,OAAP,IAAkBf,MAAM,CAACgB,WAAzB,IAAwCC,QAAQ,CAACC,eAAT,CAAyBC,SAA/E;;AACA,UAAGnB,MAAM,CAACoB,WAAP,GAAqBL,OAArB,IAAgCE,QAAQ,CAACI,IAAT,CAAcC,YAAd,GAA6B,EAAhE,EAAoE;AAChE,aAAKxB,YAAL;AACH;AACJ;;;iCAEY;AACT,UAAMyB,SAAS,GAAG,KAAK3B,KAAL,CAAWC,IAAX,CAAgB2B,GAAhB,CAAoB,UAAA3B,IAAI,EAAI;AAC1C,eACI;AACA;AAAG,YAAA,SAAS,EAAC,iBAAb;AAA+B,YAAA,GAAG,EAAEA,IAAI,CAAC4B,MAAzC;AAAiD,YAAA,IAAI,EAAC,GAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACI,oBAAC,QAAD;AAAU,YAAA,IAAI,EAAE5B,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADJ;AAFJ;AAMH,OAPiB,CAAlB;AAQA,aACI;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAK,QAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACK0B,SADL,CADJ,CADJ;AAOH;;;6BAEQ;AACL,UAAG,CAAC,KAAK3B,KAAL,CAAWC,IAAf,EAAqB;AACjB,eACI;AAAK,UAAA,EAAE,EAAC,iBAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ;AAKH,OAND,MAMO;AACH,eACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACK,KAAK6B,UAAL,EADL,CADJ;AAKH;AACJ;;;;EAnEmBlC,KAAK,CAACmC,S;;AAsE9B,eAAehC,SAAf","sourcesContent":["import React from 'react';\n//import './NewsPanel.css';\nimport _ from 'lodash';\nimport NewsCard from '../NewsCard/NewsCard';\nclass NewsPanel extends React.Component {\n    constructor() {\n        super();\n        this.state = {news: null};\n    }\n\n    componentDidMount() {\n        this.loadMoreNews();\n        this.loadMoreNews = _.debounce(this.loadMoreNews, 1000);\n        window.addEventListener('scroll', () => this.handleScroll());\n    }\n\n    loadMoreNews() {\n        //TODO: send real http request;\n        const news_url = 'http://' + window.location.hostname + ':3000/news';\n        const request= new Request(news_url, {method:'GET'});\n\n        fetch(request)\n            .then(res => res.json())\n            .then(news => {\n                this.setState({news: this.state.news ? this.state.news.concat(news) : news\n                })\n            })\n    }\n\n    handleScroll() {\n        //document.body.offsetHeight\n        //scrollY\n        //window.innerHeight\n        let scrollY = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;\n        if(window.innerHeight + scrollY >= document.body.offsetHeight - 50) {\n            this.loadMoreNews();\n        }\n    }\n\n    renderNews() {\n        const news_list = this.state.news.map(news => {\n            return(\n                //every news has a special digest, use it as key\n                <a className='list-group-item' key={news.digest} href='#'>\n                    <NewsCard news={news}></NewsCard>\n                </a>\n            );\n        });\n        return(\n            <div className=\"container-fluid\">\n                <div className='list-group'>\n                    {news_list}\n                </div>\n            </div>\n        )\n    }\n\n    render() {\n        if(!this.state.news) {\n            return(\n                <div id='msg-app-loading'>\n                    loading...\n                </div>\n            );\n        } else {\n            return(\n                <div>\n                    {this.renderNews()}\n                </div>\n            );\n        }\n    }\n}\n\nexport default NewsPanel;"]},"metadata":{},"sourceType":"module"}